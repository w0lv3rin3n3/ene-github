<!DOCTYPE html>
<html>
  <head>
    <title>Temp Sensor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <!-- <script src="js/moment-with-locales.js"></script> -->
    <link rel="stylesheet" href="src/app.css" />
  </head>

  <body>
    <div id="feed"></div>
    <div id="ledState"></div>
    <h4>Control LED</h4>
    <button onClick="setLedState(1)">Turn on</button>
    <button onClick="setLedState(0)">Turn off</button>
    <br /><br />
    <button onClick="getIRData('light_up')">Light Up</button>
    <button onClick="getIRData('light_down')">Light Down</button>
    <button onClick="getIRData('off')">OFF</button>
    <button onClick="getIRData('on')">ON</button>
    <button onClick="getIRData('red')">RED</button>
    <button onClick="getIRData('green')">GREEN</button>
    <button onClick="getIRData('blue')">BLUE</button>
    <button onClick="getIRData('white')">WHITE</button>
    <br /><br />
    <div class="charts">
      <div class="chart-container-temp">
        <canvas id="myChartTemp"></canvas>
      </div>
      <div class="chart-container-gas">
        <canvas id="myChartGas"></canvas>
      </div>
    </div>
    <script type="text/javascript">
      function setLedState(state) {
        fetch(`http://localhost:3000/slider-input/send/${state}`)
          .then((response) => response.json())
          .then((data) => {
            feedDisplay.insertAdjacentHTML("afterbegin", "Data sent");
          })
          .catch((err) => console.log(err));
      }
      function getIRData(command_name) {
        fetch(`http://localhost:3000/commandIR/send/${command_name}`)
          .then((response) => response.json())
          .then((data) => {
            const requestObj = {
              protocol: data[data.length-1].protocol,
              address: data[data.length-1].address,
              command_code: data[data.length-1].command_code,
            };
            console.log(requestObj);
            console.log("string:" + JSON.stringify(requestObj));
            fetch(`http://localhost:3000/commandIR/send`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(requestObj),
            })
              .then((response) => response.json())
              .then((data) => {
                feedDisplay.insertAdjacentHTML("afterbegin", "Data sent");
              })
              .catch((err) => console.log(err));
            feedDisplay.insertAdjacentHTML("afterbegin", "Data sent");
          })
          .catch((err) => console.log(err));
      }
      // function sendIRData(addr, cmd) {
      //   const requestObj = {
      //     protocol: "NEC",
      //     address: addr,
      //     command_code: cmd,
      //   };
      //   console.log(requestObj);
      //   console.log("string:" + JSON.stringify(requestObj));
      //   fetch(`http://localhost:3000/commandIR/send`, {
      //     method: "POST",
      //     headers: {
      //       "Content-Type": "application/json",
      //     },
      //     body: JSON.stringify(requestObj),
      //   })
      //     .then((response) => response.json())
      //     .then((data) => {
      //       feedDisplay.insertAdjacentHTML("afterbegin", "Data sent");
      //     })
      //     .catch((err) => console.log(err));
      // }
    </script>
    <script src="src/feedTemp.js"></script>
    <script src="src/feedGas.js"></script>
  </body>
</html>
